{% extends 'base.html' %}
{% load static %}

{% block title %}Verify Reset Code - GreenGardens{% endblock %}

{% block content %}
<section class="breadcrumb-section" style="background-image: url('{% static "assets/images/backgrounds/breadcrumb-bg.jpg" %}');">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb-content">
                    <h1>Verify Reset Code</h1>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Verify Reset Code</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="contact-section section-padding">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-8">
                <div class="contact-form">
                    <div class="section-title text-center mb-4">
                        <h2>Enter Verification Code</h2>
                        <p>Please enter the 6-digit verification code sent to your email address.</p>
                    </div>

                    {% if messages %}
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                    {% endif %}

                    <form method="post" action="{% url 'password_reset_verify' %}">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <input type="email" 
                                           class="form-control" 
                                           name="email" 
                                           placeholder="Enter your email address" 
                                           required>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-group">
                                    <input type="text" 
                                           class="form-control text-center" 
                                           name="verification_code" 
                                           placeholder="Enter 6-digit verification code" 
                                           maxlength="6"
                                           pattern="[0-9]{6}"
                                           style="font-size: 24px; letter-spacing: 0.5em;"
                                           required>
                                    <small class="form-text text-muted">
                                        Code expires in 15 minutes
                                    </small>
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-check me-2"></i>Verify Code
                                </button>
                            </div>
                        </div>
                    </form>

                    <div class="text-center mt-4">
                        <p>Didn't receive the code? <a href="{% url 'password_reset' %}" class="text-primary">Request a new one</a></p>
                        <p><a href="{% url 'login' %}" class="text-secondary">Back to Login</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// Auto-format verification code input
document.querySelector('input[name="verification_code"]').addEventListener('input', function(e) {
    // Only allow numbers
    this.value = this.value.replace(/[^0-9]/g, '');
    
    // Limit to 6 digits
    if (this.value.length > 6) {
        this.value = this.value.slice(0, 6);
    }
});

// Auto-submit when 6 digits are entered
document.querySelector('input[name="verification_code"]').addEventListener('input', function(e) {
    if (this.value.length === 6) {
        // Optional: auto-submit form when 6 digits are entered
        // this.form.submit();
    }
});
</script>
{% endblock %}